// Generated by psc version 0.7.4.1
"use strict";
var Prelude = require("Prelude");
var Data_Maybe = require("Data.Maybe");
var Data_Tuple = require("Data.Tuple");
var Data_Exists = require("Data.Exists");
var Data_Either = require("Data.Either");
var Data_Bifunctor = require("Data.Bifunctor");
var Control_Bind = require("Control.Bind");
var Control_Monad_Trans = require("Control.Monad.Trans");
var Control_Monad_Rec_Class = require("Control.Monad.Rec.Class");
var Bound = (function () {
    function Bound(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Bound.create = function (value0) {
        return function (value1) {
            return new Bound(value0, value1);
        };
    };
    return Bound;
})();
var FreeT = (function () {
    function FreeT(value0) {
        this.value0 = value0;
    };
    FreeT.create = function (value0) {
        return new FreeT(value0);
    };
    return FreeT;
})();
var Bind = (function () {
    function Bind(value0) {
        this.value0 = value0;
    };
    Bind.create = function (value0) {
        return new Bind(value0);
    };
    return Bind;
})();
var monadTransFreeT = function (__dict_Functor_4) {
    return new Control_Monad_Trans.MonadTrans(function (__dict_Monad_5) {
        return function (ma) {
            return new FreeT(function (_466) {
                return Prelude.map(((__dict_Monad_5["__superclass_Prelude.Bind_1"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Either.Left.create)(ma);
            });
        };
    });
};
var freeT = FreeT.create;
var bound = function (m) {
    return function (f) {
        return new Bind(Data_Exists.mkExists(new Bound(m, f)));
    };
};
var functorFreeT = function (__dict_Functor_12) {
    return function (__dict_Functor_13) {
        return new Prelude.Functor(function (f) {
            return function (_472) {
                if (_472 instanceof FreeT) {
                    return new FreeT(function (_460) {
                        return Prelude.map(__dict_Functor_13)(Data_Bifunctor.bimap(Data_Either.bifunctorEither)(f)(Prelude.map(__dict_Functor_12)(Prelude.map(functorFreeT(__dict_Functor_12)(__dict_Functor_13))(f))))(_472.value0(Prelude.unit));
                    });
                };
                if (_472 instanceof Bind) {
                    return Data_Exists.runExists(function (_461) {
                        return bound(_461.value0)(function (_1599) {
                            return Prelude.map(functorFreeT(__dict_Functor_12)(__dict_Functor_13))(f)(_461.value1(_1599));
                        });
                    })(_472.value0);
                };
                throw new Error("Failed pattern match: " + [ f.constructor.name, _472.constructor.name ]);
            };
        });
    };
};
var bimapFreeT = function (__dict_Functor_16) {
    return function (__dict_Functor_17) {
        return function (nf) {
            return function (nm) {
                return function (_470) {
                    if (_470 instanceof Bind) {
                        return Data_Exists.runExists(function (_468) {
                            return bound(function (_1600) {
                                return bimapFreeT(__dict_Functor_16)(__dict_Functor_17)(nf)(nm)(_468.value0(_1600));
                            })(function (_1601) {
                                return bimapFreeT(__dict_Functor_16)(__dict_Functor_17)(nf)(nm)(_468.value1(_1601));
                            });
                        })(_470.value0);
                    };
                    if (_470 instanceof FreeT) {
                        return new FreeT(function (_469) {
                            return Prelude["<$>"](__dict_Functor_17)(Prelude.map(Data_Either.functorEither)(function (_1602) {
                                return nf(Prelude.map(__dict_Functor_16)(bimapFreeT(__dict_Functor_16)(__dict_Functor_17)(nf)(nm))(_1602));
                            }))(nm(_470.value0(Prelude.unit)));
                        });
                    };
                    throw new Error("Failed pattern match: " + [ nf.constructor.name, nm.constructor.name, _470.constructor.name ]);
                };
            };
        };
    };
};
var hoistFreeT = function (__dict_Functor_18) {
    return function (__dict_Functor_19) {
        return bimapFreeT(__dict_Functor_18)(__dict_Functor_19)(Prelude.id(Prelude.categoryFn));
    };
};
var interpret = function (__dict_Functor_20) {
    return function (__dict_Functor_21) {
        return function (nf) {
            return bimapFreeT(__dict_Functor_20)(__dict_Functor_21)(nf)(Prelude.id(Prelude.categoryFn));
        };
    };
};
var monadFreeT = function (__dict_Functor_8) {
    return function (__dict_Monad_9) {
        return new Prelude.Monad(function () {
            return applicativeFreeT(__dict_Functor_8)(__dict_Monad_9);
        }, function () {
            return bindFreeT(__dict_Functor_8)(__dict_Monad_9);
        });
    };
};
var bindFreeT = function (__dict_Functor_14) {
    return function (__dict_Monad_15) {
        return new Prelude.Bind(function () {
            return applyFreeT(__dict_Functor_14)(__dict_Monad_15);
        }, function (_473) {
            return function (f) {
                if (_473 instanceof Bind) {
                    return Data_Exists.runExists(function (_464) {
                        return bound(_464.value0)(function (x) {
                            return bound(function (_463) {
                                return _464.value1(x);
                            })(f);
                        });
                    })(_473.value0);
                };
                return bound(function (_465) {
                    return _473;
                })(f);
            };
        });
    };
};
var applyFreeT = function (__dict_Functor_22) {
    return function (__dict_Monad_23) {
        return new Prelude.Apply(function () {
            return functorFreeT(__dict_Functor_22)(((__dict_Monad_23["__superclass_Prelude.Bind_1"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]());
        }, Prelude.ap(monadFreeT(__dict_Functor_22)(__dict_Monad_23)));
    };
};
var applicativeFreeT = function (__dict_Functor_24) {
    return function (__dict_Monad_25) {
        return new Prelude.Applicative(function () {
            return applyFreeT(__dict_Functor_24)(__dict_Monad_25);
        }, function (a) {
            return new FreeT(function (_462) {
                return Prelude.pure(__dict_Monad_25["__superclass_Prelude.Applicative_0"]())(new Data_Either.Left(a));
            });
        });
    };
};
var liftFreeT = function (__dict_Functor_10) {
    return function (__dict_Monad_11) {
        return function (fa) {
            return new FreeT(function (_467) {
                return Prelude["return"](__dict_Monad_11["__superclass_Prelude.Applicative_0"]())(new Data_Either.Right(Prelude.map(__dict_Functor_10)(Prelude.pure(applicativeFreeT(__dict_Functor_10)(__dict_Monad_11)))(fa)));
            });
        };
    };
};
var resume = function (__dict_Functor_0) {
    return function (__dict_MonadRec_1) {
        var go = function (_471) {
            if (_471 instanceof FreeT) {
                return Prelude.map((((__dict_MonadRec_1["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Bind_1"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Either.Right.create)(_471.value0(Prelude.unit));
            };
            if (_471 instanceof Bind) {
                return Data_Exists.runExists(function (_459) {
                    var _1578 = _459.value0(Prelude.unit);
                    if (_1578 instanceof FreeT) {
                        return Prelude.bind((__dict_MonadRec_1["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Bind_1"]())(_1578.value0(Prelude.unit))(function (_25) {
                            if (_25 instanceof Data_Either.Left) {
                                return Prelude["return"]((__dict_MonadRec_1["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Applicative_0"]())(new Data_Either.Left(_459.value1(_25.value0)));
                            };
                            if (_25 instanceof Data_Either.Right) {
                                return Prelude["return"]((__dict_MonadRec_1["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Applicative_0"]())(new Data_Either.Right(new Data_Either.Right(Prelude.map(__dict_Functor_0)(function (h) {
                                    return Prelude[">>="](bindFreeT(__dict_Functor_0)(__dict_MonadRec_1["__superclass_Prelude.Monad_0"]()))(h)(_459.value1);
                                })(_25.value0))));
                            };
                            throw new Error("Failed pattern match at Control.Monad.Free.Trans line 45, column 3 - line 46, column 3: " + [ _25.constructor.name ]);
                        });
                    };
                    if (_1578 instanceof Bind) {
                        return Data_Exists.runExists(function (_458) {
                            return Prelude["return"]((__dict_MonadRec_1["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Applicative_0"]())(new Data_Either.Left(Prelude.bind(bindFreeT(__dict_Functor_0)(__dict_MonadRec_1["__superclass_Prelude.Monad_0"]()))(_458.value0(Prelude.unit))(function (z) {
                                return Prelude[">>="](bindFreeT(__dict_Functor_0)(__dict_MonadRec_1["__superclass_Prelude.Monad_0"]()))(_458.value1(z))(_459.value1);
                            })));
                        })(_1578.value0);
                    };
                    throw new Error("Failed pattern match at Control.Monad.Free.Trans line 45, column 3 - line 46, column 3: " + [ _1578.constructor.name ]);
                })(_471.value0);
            };
            throw new Error("Failed pattern match at Control.Monad.Free.Trans line 45, column 3 - line 46, column 3: " + [ _471.constructor.name ]);
        };
        return Control_Monad_Rec_Class.tailRecM(__dict_MonadRec_1)(go);
    };
};
var runFreeT = function (__dict_Functor_2) {
    return function (__dict_MonadRec_3) {
        return function (interp) {
            var go = function (_474) {
                if (_474 instanceof Data_Either.Left) {
                    return Prelude["return"]((__dict_MonadRec_3["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Applicative_0"]())(new Data_Either.Right(_474.value0));
                };
                if (_474 instanceof Data_Either.Right) {
                    return Prelude.bind((__dict_MonadRec_3["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Bind_1"]())(interp(_474.value0))(function (_27) {
                        return Prelude["return"]((__dict_MonadRec_3["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Applicative_0"]())(new Data_Either.Left(_27));
                    });
                };
                throw new Error("Failed pattern match at Control.Monad.Free.Trans line 105, column 3 - line 106, column 3: " + [ _474.constructor.name ]);
            };
            return Control_Monad_Rec_Class.tailRecM(__dict_MonadRec_3)(Control_Bind["<=<"]((__dict_MonadRec_3["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Bind_1"]())(go)(resume(__dict_Functor_2)(__dict_MonadRec_3)));
        };
    };
};
var monadRecFreeT = function (__dict_Functor_6) {
    return function (__dict_Monad_7) {
        return new Control_Monad_Rec_Class.MonadRec(function () {
            return monadFreeT(__dict_Functor_6)(__dict_Monad_7);
        }, function (f) {
            var go = function (s) {
                return Prelude.bind(bindFreeT(__dict_Functor_6)(__dict_Monad_7))(f(s))(function (_26) {
                    if (_26 instanceof Data_Either.Left) {
                        return go(_26.value0);
                    };
                    if (_26 instanceof Data_Either.Right) {
                        return Prelude["return"](applicativeFreeT(__dict_Functor_6)(__dict_Monad_7))(_26.value0);
                    };
                    throw new Error("Failed pattern match at Control.Monad.Free.Trans line 75, column 1 - line 85, column 1: " + [ _26.constructor.name ]);
                });
            };
            return go;
        });
    };
};
module.exports = {
    runFreeT: runFreeT, 
    resume: resume, 
    bimapFreeT: bimapFreeT, 
    interpret: interpret, 
    hoistFreeT: hoistFreeT, 
    liftFreeT: liftFreeT, 
    freeT: freeT, 
    functorFreeT: functorFreeT, 
    applyFreeT: applyFreeT, 
    applicativeFreeT: applicativeFreeT, 
    bindFreeT: bindFreeT, 
    monadFreeT: monadFreeT, 
    monadTransFreeT: monadTransFreeT, 
    monadRecFreeT: monadRecFreeT
};
